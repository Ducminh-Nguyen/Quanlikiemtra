<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="./assets/css/style.css" />
    <link rel="stylesheet" href="./assets/css/indexroom.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>H·ªá th·ªëng Qu·∫£n l√Ω L·ªãch B√†i Ki·ªÉm Tra</h1>
        <div class="header-actions">
          <button
            onclick="window.location.href='indexroom.html'"
            class="btn btn-add"
          >
            + ƒê·∫∑t l·ªãch b√†i ki·ªÉm tra
          </button>
          <button
            onclick="window.location.href='profile.html'"
            class="btn btn-secondary"
          >
            üë§ Th√¥ng tin c√° nh√¢n
          </button>
          <span id="userEmail"></span>
          <button id="logoutBtn" class="btn btn-secondary" a href="login.html">
            ƒêƒÉng xu·∫•t
          </button>
        </div>
      </header>

      <!-- Main Content -->
      <main class="main-content">
        <section class="form-section">
          <div id="roomForm">
            <div class="form-row">
              <div class="form-group">
                <label for="roomName">B√†i ki·ªÉm tra</label>
                <select id="roomName" required>
                  <option value="">-- Ch·ªçn b√†i ki·ªÉm tra --</option>
                  <option value="B√†i ki·ªÉm tra  1">B√†i ki·ªÉm tra 1</option>
                  <option value="B√†i ki·ªÉm tra ">B√†i ki·ªÉm tra 2</option>
                  <option value="B√†i ki·ªÉm tra  3">B√†i ki·ªÉm tra 3</option>
                  <option value="B√†i ki·ªÉm tra  4">B√†i ki·ªÉm tra 4</option>
                  <option value="B√†i ki·ªÉm tra  5">B√†i ki·ªÉm tra 5</option>
                  <option value="B√†i ki·ªÉm tra  6">B√†i ki·ªÉm tra 6</option>
                  <option value="B√†i ki·ªÉm tra  7">B√†i ki·ªÉm tra 7</option>
                  <option value="B√†i ki·ªÉm tra  8">B√†i ki·ªÉm tra 8</option>
                  <option value="B√†i ki·ªÉm tra  9">B√†i ki·ªÉm tra 9</option>
                  <option value="B√†i ki·ªÉm tra  10">B√†i ki·ªÉm tra 10</option>
                  <option value="B√†i ki·ªÉm tra  11">B√†i ki·ªÉm tra 11</option>
                  <option value="B√†i ki·ªÉm tra  12">B√†i ki·ªÉm tra 12</option>
                  <option value="B√†i ki·ªÉm tra  13">B√†i ki·ªÉm tra 13</option>
                  <option value="B√†i ki·ªÉm tra  14">B√†i ki·ªÉm tra 14</option>
                  <option value="B√†i ki·ªÉm tra  kh√°c">B√†i ki·ªÉm tra kh√°c</option>
                </select>
              </div>
              <div class="form-group">
                <label for="bookingDate">Ng√†y s·ª≠ d·ª•ng:</label>
                <input type="date" id="bookingDate" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="startTime">Th·ªùi gian b·∫Øt ƒë·∫ßu:</label>
                <input type="time" id="startTime" required />
              </div>
              <div class="form-group">
                <label for="endTime">Th·ªùi gian k·∫øt th√∫c:</label>
                <input type="time" id="endTime" required />
              </div>
            </div>
            <div class="form-group">
              <label for="purpose">M·ª•c ƒë√≠ch s·ª≠ d·ª•ng:</label>
              <textarea
                id="purpose"
                rows="4"
                required
                placeholder="V√≠ d·ª•:To√°n,Ti·∫øng Anh,VƒÉn..."
              ></textarea>
            </div>
            <div class="form-group"> 
              <label for="notes">Ghi ch√∫:</label>
              <textarea
                id="notes"
                rows="3"
                placeholder="Ghi ch√∫ th√™m (kh√¥ng b·∫Øt bu·ªôc)"
              ></textarea>
            </div>
            <div class="form-actions">
              <button type="button" id="addBtn" class="btn btn-primary">
                ƒê·∫∑t l·ªãch b√†i ki·ªÉm tra
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                onclick="window.location.href='index.html'"
              >
                H·ªßy
              </button>
            </div>
          </div>
        </section>
      </main>
    </div>
    <script type="module">
      // Import the functions you need from the SDKs you need
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
      import {
        onAuthStateChanged,
        getAuth,
        signOut,
      } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
      import {
        getFirestore,
        collection,
        addDoc,
      } from "https://www.gstatic.com/firebasejs/12.7.0/firebase- firestore.js";
      // TODO: Add SDKs for Firebase products that you want to use
      // https://firebase.google.com/docs/web/setup#available-libraries

      // Your web app's Firebase configuration
      // For Firebase JS SDK v7.20.0 and later, measurementId is optional
      const firebaseConfig = {
        apiKey: "AIzaSyAmdUsIpWyY7FYxX1j0PZrwVaiE1KWRLu8",
        authDomain: "spck-84726.firebaseapp.com",
        projectId: "spck-84726",
        storageBucket: "spck-84726.firebasestorage.app",
        messagingSenderId: "377528554028",
        appId: "1:377528554028:web:940f3092c9c7625f197789",
        measurementId: "G-XY9FXY7MQK",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);

      document.getElementById("addBtn").addEventListener("click", async () => {
        const roomName = document.getElementById("roomName").value;
        const bookingDate = document.getElementById("bookingDate").value;
        const startTime = document.getElementById("startTime").value;
        const endTime = document.getElementById("endTime").value;
        const purpose = document.getElementById("purpose").value.trim();
        const notes = document.getElementById("notes").value.trim();
      });
      if (!roomName) {
        alert("Vui l√≤ng ch·ªçn ph√≤ng h·ªçc!");
        return;
      }
      if (!bookingDate) {
        alert("Vui l√≤ng ch·ªçn ng√†y s·ª≠ d·ª•ng!");
        return;
      }
      if (!startTime || !endTime) {
        alert("Vui l√≤ng nh·∫≠p th·ªùi gian!");
        return;
      }
      if (startTime >= endTime) {
        alert("Th·ªùi gian k·∫øt th√∫c ph·∫£i sau th·ªùi gian b·∫Øt ƒë·∫ßu!");
        return;
      }
      if (!purpose) {
        alert("Vui l√≤ng nh·∫≠p m·ª•c ƒë√≠ch s·ª≠ d·ª•ng!");
        return;
      }

      const bookingData = {
        roomName: roomName,
        bookingDate: bookingDate,
        startTime: startTime,
        endTime: endTime,
        purpose: purpose,
        notes: notes,
        userId: currentUser.uid,
        userEmail: currentUser.email,
        createdAt: new Date().toISOString(),
      };

      try {
        await addDoc(collection(db, "bookings"), bookingData);
        alert("ƒê·∫∑t l·ªãch th√†nh c√¥ng!");
        window.location.href = "index.html";
      } catch (error) {
        alert("C√≥ l·ªói x·∫£y ra: " + error.message);
      }
    </script>
  </body>
</html>
